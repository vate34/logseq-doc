# 基本概念
- 注册中心的三种角色：
	- **服务提供者（RPC Server）**：在启动时，向 Registry 注册自身服务，并向 Registry 定期发送心跳汇报存活状态。
	- **服务消费者（RPC Client）**：在启动时，向 Registry 订阅服务，把 Registry 返回的服务节点列表缓存在本地内存中，并与 RPC Sever 建立连接。
	- **服务注册中心（Registry）**：用于保存 RPC Server 的注册信息，当 RPC Server 节点发生变更时，Registry 会同步变更，RPC Client 感知后会刷新本地 内存中缓存的服务节点列表。
- # 功能
- 注册中心的API
	- 服务注册接口。服务的提供方调用注册接口完成服务注册
	- 服务注销接口。服务的提供方调用注销接口完成服务的下线
	- 心跳检查。服务的提供方通过心跳汇报接口完成服务状态上报
	- 服务查询。消费者通过订阅或者定时拉去的服务列表信息
	- 服务变更查询。当服务发生变更的时候消费者通过变更服务获取到最新的服务信息
- 服务的高可用
- 存储格式和位置
- 服务健康检查
- 服务状态变更通知
- 白名单机制
- # 相关理论
- ## CAP
- CAP理论是分布式框架重要理论
	- 一致性(Consistency)：所有节点在同一时间具有相同的数据
	- 可用性(Availability) ：保证每个请求不管成功或者失败都有响应
	- 分隔容忍(Partition tolerance) ：系统中任意信息的丢失或失败不会影响整个系统的继续运作。
- CAP不可能全部满足，只能取其中两个。
- > 如果C是第一需求的话，那么会影响A的性能，因为要数据同步，不然请求结果会有差异，但是数据同步会消耗时间，期间可用性就会降低。
  如果A是第一需求，那么只要有一个服务在，就能正常接受请求，但是对于返回结果变不能保证，原因是，在分布式部署的时候，数据一致的过程不可能想切线路那么快。
  再如果，同时满足一致性和可用性，那么分区容错就很难保证了，也就是单点，也是分布式的基本核心。
- ## 协议
- Paxos。Paxos只需超过半数的副本在线且相互通信正常，就可以保证服务的持续可用，且数据不丢失。
- Raft。Raft是Paxos的简化版，与Paxos相比，Raft强调的是易理解、易实现，Raft和Paxos一样只要保证超过半数的节点正常就能够提供服务。
- ZAB。ZooKeeper Atomic Broadcast (ZAB, ZooKeeper原子消息广播协议)是ZooKeeper实现分布式数据一致性的核心算法，ZAB借鉴Paxos算法，但又不像Paxos算法那样，是一种通用的分布式一致性算法，它是一种特别为ZooKeeper专门设计的支持崩溃恢复的原子广播协议。
- # 常用注册中心
- [[ZooKeeper]]
- [[Eureka]]
- [[Nacos]]
- [[Consul]]
- [[ETCD]]
-